<nb-card class="trade">
  <nb-card-header>{{"common.trade" | translate}}</nb-card-header>
  <nb-card-body>
      <div class="available-items">
    <ul id="main-navigation-trade" class="nav navbar-pill tradeLine tabs text-center">
      <li class="pointer active tab-link" data-tab="tab-1">
        <a data-toggle="pill">{{"pages.exchange.buy" | translate | uppercase}} {{tradeByu.from | uppercase}}</a>
      </li>
      <li class="pointer tab-link" data-tab="tab-2">
        <a data-toggle="pill">{{"pages.exchange.sell" | translate | uppercase}} {{tradeByu.from | uppercase}}</a>
      </li>
    </ul>

    <div id="tab-1" class="tab-content active">
      <form (ngSubmit)="submitTradeBuy()">
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"pages.exchange.price" | translate}}</label>
            <label class="label-right font-avenir">
              <span *ngIf="!fetchingBuyAmount">
                ${{ buyWalletDollar | number : '1.0-2' }}
              </span>
              <span class="transfer-amount"><i class="fa fa-spinner fa-spin"
                *ngIf="fetchingBuyAmount"></i></span>
            </label>
            <input type="number" class="form-control" name="price" [(ngModel)]="tradeByu.price"
              (keyup)="setBuyAmount(tradeByu.to)">
            <span class="form-control-feedback">{{tradeByu.to | uppercase}}</span>
          </div>
        </div>
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"common.amount" | translate}}</label>
            <label class="label-max font-avenir">{{"pages.exchange.max" | translate | uppercase}}</label>
            <input type="number" class="form-control" name="amount" [(ngModel)]="tradeByu.amount" (keyup)="setBuyTotalAmount(tradeByu.to)">
            <span class="form-control-feedback">{{tradeByu.from | uppercase}}</span>
          </div>
        </div>
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"common.total" | translate}}</label>
            <label class="label-right font-avenir">
              <span *ngIf="!fetchingBuyTotalAmount">
                ${{ buyTotalWalletDollar | number : '1.0-2' }}
              </span>
              <span class="transfer-amount"><i class="fa fa-spinner fa-spin"
                *ngIf="fetchingBuyTotalAmount"></i></span>
            </label>
            <input type="text" class="form-control" name="btc"
              [value]="tradeByu.price * tradeByu.amount" disabled>
            <span class="form-control-feedback">{{tradeByu.to | uppercase}}</span>
          </div>
        </div>
        <span>
          <a class="pointer green-text withdraw-text" (click)="openDialog(WithdrawModel)">{{"pages.exchange.withdraw" | translate | uppercase}}</a>
          <a class="pointer green-text deposit-text" (click)="openDialog(depositModel)">{{"pages.exchange.deposit" | translate | uppercase}}</a>
        </span>
        <div class="text-center">
          <button type="submit" class="font-bebasNeueBold btn btn-run btn-demo btn-success pointer" size="large" [disabled]="formSubmittingBuy">
            <span *ngIf="!formSubmittingBuy">{{"pages.exchange.placeBuyOrder" | translate}}</span>
            <i class="fa fa-spinner fa-spin text-white" *ngIf="formSubmittingBuy"></i>
          </button>
        </div>
      </form>
    </div>

    <div id="tab-2" class="tab-content" >
      <form (ngSubmit)="submitTradeSell()">
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"pages.exchange.price" | translate}}</label>
            <label class="label-right font-avenir">
              <span *ngIf="!fetchingSellAmount">
                ${{ sellWalletDollar | number : '1.0-2' }}
              </span>
              <span class="transfer-amount"><i class="fa fa-spinner fa-spin"
                *ngIf="fetchingSellAmount"></i></span>
            </label>
            <input type="number" class="form-control" name="price"
              [(ngModel)]="tradeSell.price" (keyup)="setSellAmount(tradeSell.to)">
            <span class="form-control-feedback">{{tradeSell.to | uppercase}}</span>
          </div>
        </div>
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"common.amount" | translate}}</label>
            <label class="label-max font-avenir">{{"pages.exchange.max" | translate | uppercase}}</label>
            <input type="number" class="form-control" name="amount" [(ngModel)]="tradeSell.amount" (keyup)="setSellTotalAmount(tradeSell.to)">
            <span class="form-control-feedback">{{tradeSell.from | uppercase}}</span>
          </div>
        </div>
        <div class="form-group">
          <div class="form-group has-feedback">
            <label class="text-success">{{"common.total" | translate}}</label>
            <label class="label-right font-avenir">
              <span *ngIf="!fetchingSellTotalAmount">
                ${{ sellTotalWalletDollar | number : '1.0-2' }}
              </span>
              <span class="transfer-amount"><i class="fa fa-spinner fa-spin"
                *ngIf="fetchingSellTotalAmount"></i></span>
            </label>
            <input type="text" class="form-control" name="total"
              [value]="tradeSell.price * tradeSell.amount" disabled>
            <span class="form-control-feedback">{{tradeSell.to | uppercase}}</span>
          </div>
        </div>
        <span>
          <a class="pointer green-text withdraw-text" (click)="openDialog(WithdrawModel)">
              {{"pages.exchange.withdraw" | translate |uppercase }}
          </a>
          <a class="pointer green-text deposit-text" (click)="openDialog(depositModel)">
            {{"pages.exchange.deposit" | translate | uppercase}}
          </a>
        </span>
        <div class="text-center">
          <button type="submit" class="font-bebasNeueBold btn btn-run btn-demo btn-danger pointer" size="large" [disabled]="formSubmittingSell">
            <span *ngIf="!formSubmittingSell">{{"pages.exchange.placeSellOrder" | translate}}</span>
            <i class="fa fa-spinner fa-spin text-white" *ngIf="formSubmittingSell"></i>
          </button>
        </div>
      </form>
    </div>
    </div>
  </nb-card-body>

</nb-card>

<ng-template #WithdrawModel let-data let-ref="dialogRef">
  <nb-card class="modal-popup-size" [size]="'giant'">
    <nb-card-header class="header-popup">{{"pages.exchange.withdraw" | translate | uppercase}}
      <i class="nb-close nb-icon-left fa-2x" (click)="cancelDialog(ref)"></i>
    </nb-card-header>
    <nb-card-body class="image-scoll-card-body">
      <div class="form-group font-avenir">
        <label class="text-success">{{"common.from" | translate}}</label>
        <div class="dropdown" ngbDropdown>
          <button type="button" ngbDropdownToggle class="font-avenir dropDown-padding btn btn-primary b-color-wallet"
            [ngClass]="{'btn-sm': breakpoint.width <= breakpoints.is}">
            {{ seletedCryptoWithdrawData.name }}
          </button>
          <ul class="dropdown-menu" ngbDropdownMenu>
            <li class="dropdown-item" class="dropdown-item {{seletedCryptoWithdrawData.name === cryto.name ? 'active' : ''}}" *ngFor="let cryto of availableWallets" (click)="changeWithdrawCrypto(cryto)">
              {{cryto.name}}
            </li>
          </ul>
        </div>
      </div>

      <br>
      <div class="form-group">
        <div class="form-group">
          <label class="text-success">{{"common.amount" | translate}}</label>
          <label class="label-max font-avenir">{{withdrawWalletAmount | number: '1.0-2'}} {{seletedCryptoWithdrawData.name}} / {{"pages.exchange.max" | translate | uppercase}}</label>
          <input type="number" class="form-control" placeholder="{{'pages.heaven.enterAmount' | translate}}" [(ngModel)]="withdrawAmount">
        </div>
      </div>
    </nb-card-body>
    <nb-card-footer>
      <button class="withdraw-btn btn btn-success pointer" fullwidth
        (click)="submitWithdrawDialog(ref)"
        [disabled]="submitWithdrawDisable">
        {{"pages.exchange.withdraw" | translate}}
      </button>
    </nb-card-footer>
  </nb-card>
</ng-template>

<ng-template #depositModel let-data let-ref="dialogRef">
  <nb-card  class="modal-popup-size">
    <nb-card-header class="header-popup">
        {{"pages.exchange.deposit" | translate | uppercase}}
      <i class="nb-close nb-icon-left fa-2x" (click)="cancelDialog(ref)"></i>
    </nb-card-header>
    <nb-card-body class="image-scoll-card-body" style="overflow: unset;">
      <div class="form-group font-avenir">
        <label class="text-success">{{"common.from" | translate}}</label>
        <div class="dropdown" ngbDropdown>
          <button type="button" ngbDropdownToggle class="font-avenir dropDown-padding btn btn-primary b-color-wallet"
            [ngClass]="{'btn-sm': breakpoint.width <= breakpoints.is}">
            {{ cryptoDepositType }}
          </button>
          <ul class="dropdown-menu" ngbDropdownMenu>
            <ng-container *ngFor="let cryto of availableWallets">
            <li class="dropdown-item" *ngIf="cryptoDepositType != cryto.name"
              (click)="changeDepositCrypto(cryto.name)">
              {{cryto.name}}
            </li>
            </ng-container>
          </ul>
        </div>
      </div>
      <br>

      <div class="form-group total-amount">
        <label class="text-success">{{"common.amount" | translate}}</label>
        <span class="available-amount font-avenir" (click)="setSendMaxValue()" *ngIf="seletedCryptoDepositData.name">
             {{(depositPopupAmount | number: '1.0-6') + ' ' + (seletedCryptoDepositData?.name) + ' / max' }}
        </span>
        <div class="input-group">
          <input type="number" class="form-control" [disabled]="!seletedCryptoDepositData?.name" (keyup)="setAmount(seletedCryptoDepositData?.name)" [(ngModel)]="depositAmount" placeholder="{{'pages.heaven.enterAmount' | translate}}">
          <span class="transfer-amount"><i class="fa fa-spinner fa-spin" *ngIf="fetchingAmount"></i></span>
          <span class="transfer-amount" *ngIf="!fetchingAmount">${{ seletedCryptoDepositData?.dollar_amount | number : '1.0-2' }}</span>
        </div>
      </div>

    </nb-card-body>
    <nb-card-footer>
      <button class="withdraw-btn btn btn-success pointer" fullwidth
      (click)="submitDepositDialog(ref)"
      [disabled]="submitDepositDisable"><span>{{"pages.exchange.deposit" | translate}}</span></button>
    </nb-card-footer>
  </nb-card>
</ng-template>
